{% extends 'base.html' %}

{% block title %}User: {{ user.user_id }}{% endblock %}

{% block head %}
  <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #map {
        height: 80%;
      }
    </style>

  <script async defer src="https://maps.googleapis.com/maps/api/js?v=3.exp&callback=initMap"></script>
  <script src="https://code.jquery.com/jquery.js"></script>
{% endblock %}

{% block content %}
    <div>
      <p>
        User ID {{ user.user_id }}<br>
        Name: {{ user.first_name }} {{ user.last_name }}<br>
        Email: {{ user.email }}<br>
      </p>
    </div>

    <div id="map"></div>
    <script>
      function initMap() {
        // Specify where the map is centered
        // Note re: coordinates
        // North is positive / South is negative
        // West is negative / East is positive
        var myLatLng = {lat: 37.3688, lng: -122.0363};

        // Create a map object and specify the DOM element for display
        // Customize the control options
        var map = new google.maps.Map(document.getElementById('map'), {
          center: myLatLng,
          zoom: 13,
          mapTypeControl: true,
          mapTypeControlOptions: {
            style: google.maps.MapTypeControlStyle.DROPDOWN_MENU
          },
          streetViewControl: true,
          streetViewControlOptions: {
              position: google.maps.ControlPosition.LEFT_CENTER
          },
          zoomControl: true,
          zoomControlOptions: {
            position: google.maps.ControlPosition.LEFT_CENTER
          },
        });

        // ----------- Test code for plotting a marker on the map ----------- 
        // // Give coordinates of marker
        // var markerLatLng = {lat: 37.351158, lng: -122.03274};
        // var markerLatLng = new google.maps.Latlng(37.351158, -122.032746)

        // // Create a marker object
        // var marker = new google.maps.Marker({
        //   position: markerLatLng,
        //   map: map,
        //   title: 'This is a marker!!'
        // });
        // ------------------------------------------------------------------

        // Make AJAX call to server to get JSON that has info re: user's visits
        // For every restaurant that the user has visited, get coordinates and
        // plot markers on map
        $.get('/user-visits.json', function (visits) {

          for (var key in visits) {
            var visit = visits[key];

            // Specify marker coordinates
            var markerLatLng = {lat: visit.latitude, lng: visit.longitude};

            // Create a marker object
            var marker = new google.maps.Marker({
              position: markerLatLng,
              map: map,
              title: 'Restaurant: ' + visit.restaurant
            });


          }

        });   
          
      }
    </script>

{% endblock %}