{% extends 'base.html' %}

{% block title %}User: {{ user.user_id }}{% endblock %}

{% block head %}
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    #map {
      height: 80%;
    }
  </style>

  <script src="https://code.jquery.com/jquery.js"></script> 
  <script async defer src="https://maps.googleapis.com/maps/api/js?v=3.exp&callback=initMap"></script>
  
{% endblock %}

{% block content %}

  <div id="user-info" data-userid="{{ user.user_id }}">
    <p>
      User ID {{ user.user_id }}<br>
      Name: {{ user.first_name }} {{ user.last_name }}<br>
      Email: {{ user.email }}<br>
    </p>
  </div>

  <div>
    {% if session.current_user.user_id != user.user_id %}
      {% if friends %}
        <button type="button" id="accepted-btn" disabled="true">Friends</button>
      {% elif pending_request %}
        <button type="button" id="requested-btn" disabled="true">Request Pending</button>
      {% else %}
        <form id="add-friend-form" action="/add-friend" method="post">
          <input type="submit" value="Add Friend" id="add-friend-btn">
        </form>
      {% endif %}
    {% endif %}
  </div>

  <script>
    function showSentRequest(result) {
      $("#add-friend-btn").val(result).attr("disabled", true)
    }

    function sendFriendRequest(evt) {
      evt.preventDefault();

      var formInputs = {
        "user_b_id": $("#user-info").data("userid")
      };

      $.post("/add-friend", 
             formInputs,
             showSentRequest
             );
    }

    $("#add-friend-form").on("submit", sendFriendRequest);
  </script>


  <div id="map"></div>
  <script src="/static/js/breadcrumbs-map.js"></script>

{% endblock %}